<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/the_game.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <title>Poker</title>
</head>
<body>
    <header class="p-3 text-bg-dark">
    <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
                <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
            </a>
            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                <li><a href="/" class="btn btn-outline-light me-2">Home</a></li>
                <li><a href="/about" class="btn btn-outline-light me-2">Info</a></li>
            </ul>
            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                <li class="nav-link px-2 text-white">Game ID: {{game.id}}</li>
                <li class="nav-link px-2 text-white">Round: {{game.n_round + 1}}</li>
            </ul>
        </div>
    </div>
    </header>


    <div id="main">
        <div class="players">
                <div class="player player-1" id="player1" >
                <div class="avatar" style="background: rgba(204, 51, 0, 1)">{{ game.players.split()[0] }}</div>
            </div>
                <div class="player player-2"  id="player2">
            <div class="avatar" style="background: rgba(255, 153, 102, 1)"><p>{{ game.players.split()[1] }}</p></div>
        </div>
            {% if game.number_of_players > 2 %}
                <div class="player player-3"  id="player3">
            <div class="avatar" style="background: rgba(153, 102, 255, 1)">{{ game.players.split()[2] }}</div>
        </div>
            {% endif %}
            {% if game.number_of_players > 3 %}
                <div class="player player-4"  id="player4">
            <div class="avatar" style="background: rgba(0, 102, 204, 1)">{{ game.players.split()[3] }}</div>
        </div>
            {% endif %}
            {% if game.number_of_players > 4 %}
                <div class="player player-5"  id="player5">
            <div class="avatar" style="background: rgba(102, 204, 204, 1)">{{ game.players.split()[4] }}</div>
        </div>
            {% endif %}
            {% if game.number_of_players > 5 %}
                <div class="player player-6"  id="player6">
            <div class="avatar" style="background: rgba(153, 204, 102, 1)">{{ game.players.split()[5] }}</div>

        </div>
            {% endif %}

    </div>
        <div class="cards">
            <div class="cards_player-1" id="player1_cards" >
            <div class="ava_cards" style="background: rgba(204, 51, 0, 1)">
                {% if game.simulation or game.round_ended %}
                <div class="block_cards">
                    <img src="/static/img/cards/{{players_db[0].cards.split(',')[0]}}.png"
                        width="100" height="150" alt="card1" id="player1_card_1">
                    <img src="/static/img/cards/{{players_db[0].cards.split(',')[1]}}.png"
                        width="100" height="150" alt="card2" id="player1_card_2">
                </div>
                {% else %}
                <div class="block_cards">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card2">
                </div>
                {% endif %}

                <div class="chips">chips: {{ players_db[0].chips }}</div>
                <div class="stake_info">{{players_db[0].stake_info}}</div>
            </div>
        </div>
            <div class="cards_player-2"  id="player2_cards">
            <div class="ava_cards" style="background: rgba(255, 153, 102, 1)">
                {% if game.simulation or game.round_ended %}
                <div class="block_cards">
                    <img src="/static/img/cards/{{players_db[1].cards.split(',')[0]}}.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/{{players_db[1].cards.split(',')[1]}}.png"
                        width="100" height="150" alt="card2">
                </div>
                {% else %}
                <div class="block_cards">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card2">
                </div>
                {% endif %}
                <div class="chips">chips: {{ players_db[1].chips }}</div>
                <div class="stake_info">{{players_db[1].stake_info}}</div>
            </div>
        </div>
            {% if game.number_of_players > 2 %}
                <div class="cards_player-3"  id="player3_cards">
            <div class="ava_cards" style="background: rgba(153, 102, 255, 1)">
                {% if game.simulation or game.round_ended %}
                <div class="block_cards">
                    <img src="/static/img/cards/{{players_db[2].cards.split(',')[0]}}.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/{{players_db[2].cards.split(',')[1]}}.png"
                        width="100" height="150" alt="card2">
                </div>
                {% else %}
                <div class="block_cards">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card2">
                </div>
                {% endif %}
                <div class="chips">chips: {{ players_db[2].chips }}</div>
                <div class="stake_info">{{players_db[2].stake_info}}</div>
            </div>
        </div>
            {% endif %}
            {% if game.number_of_players > 3 %}
                <div class="cards_player-4"  id="player4_cards">
            <div class="ava_cards" style="background: rgba(0, 102, 204, 1)">
                {% if game.simulation or game.round_ended %}
                <div class="block_cards">
                    <img src="/static/img/cards/{{players_db[3].cards.split(',')[0]}}.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/{{players_db[3].cards.split(',')[1]}}.png"
                        width="100" height="150" alt="card2">
                </div>
                {% else %}
                <div class="block_cards">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card2">
                </div>
                {% endif %}
                <div class="chips">chips: {{ players_db[3].chips }}</div>
                <div class="stake_info">{{players_db[3].stake_info}}</div>
            </div>
        </div>
            {% endif %}
            {% if game.number_of_players > 4 %}
                <div class="cards_player-5"  id="player5_cards">
            <div class="ava_cards" style="background: rgba(102, 204, 204, 1)">
                {% if game.simulation or game.round_ended %}
                <div class="block_cards">
                    <img src="/static/img/cards/{{players_db[4].cards.split(',')[0]}}.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/{{players_db[4].cards.split(',')[1]}}.png"
                        width="100" height="150" alt="card2">
                </div>
                {% else %}
                <div class="block_cards">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card2">
                </div>
                {% endif %}
                <div class="chips">chips: {{ players_db[4].chips }}</div>
                <div class="stake_info">{{players_db[4].stake_info}}</div>
            </div>
        </div>
            {% endif %}
            {% if game.number_of_players > 5 %}
                <div class="cards_player-6"  id="player6_cards)">
            <div class="ava_cards" style="background: rgba(153, 204, 102, 1)">
                {% if game.simulation or game.round_ended%}
                <div class="block_cards">
                    <img src="/static/img/cards/{{players_db[5].cards.split(',')[0]}}.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/{{players_db[5].cards.split(',')[1]}}.png"
                        width="100" height="150" alt="card2">
                </div>
                {% else %}
                <div class="block_cards">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card1">
                    <img src="/static/img/cards/default.png"
                        width="100" height="150" alt="card2">
                </div>
                {% endif %}
                <div class="chips">chips: {{ players_db[5].chips }}</div>
                <div class="stake_info">{{players_db[5].stake_info}}</div>
            </div>
        </div>
            {% endif %}
    </div>
        <div class='square-box'>
            <div class='square-content'> <span></span></div>
        </div>
        <div class="table_block">
            <div class="cards_on_table">
                {% if game.cards_show_status > 0%}
                    <img class="123cards"
                     src="/static/img/cards/{{game.cards_on_table.split(',')[0]}}.png"
                        width="100" height="150" alt="card1">
                    <img class="123cards"
                     src="/static/img/cards/{{game.cards_on_table.split(',')[1]}}.png"
                        width="100" height="150" alt="card2">
                    <img class="123cards"
                     src="/static/img/cards/{{game.cards_on_table.split(',')[2]}}.png"
                        width="100" height="150" alt="card3">
                {% endif %}
                {% if game.cards_show_status > 1 %}
                    <img class="4cards"
                     src="/static/img/cards/{{game.cards_on_table.split(',')[3]}}.png"
                        width="100" height="150" alt="card4">
                {% endif %}
                {% if game.cards_show_status > 2 %}
                    <img class="5cards"
                     src="/static/img/cards/{{game.cards_on_table.split(',')[4]}}.png"
                        width="100" height="150" alt="card5">
                {% endif %}
            </div>
            <div class="bank">
                bank: {{ game.pot }}
            </div>
        </div>

        {% if game.bet_ask %}
            <div class="bet_ask_block">
            <form method="POST">
                <div class="form-floating">
                    <input type="number" name="bet" id="bet" class="form-control" style="font-size: 1.5vw;"><br>
                </div>
                <input type="submit" class="w-100 btn btn-lg btn-primary" value="Сделать ставку">
            </form>
            </div>
        {% endif %}
        {% if game.row != 0 and game.row < 4 and not game.bet_ask %}
            <div class="action_block">
                <p style="margin-top: 2em; margin-bottom: 0.2em">Ход {{ players_db[id_p_now].name }}</p>
                {% if players_db[id_p_now].stake_gap != 0%}
                    <p><small>({{ players_db[id_p_now].stake_gap }} to continue)</small></p>
                {% endif %}
            <form method="POST"> <!--possible responses-->
                {% if "fold" in players_db[id_p_now].possible_responses%}
                        <div class="form-control"><input class="form-check-input" type="radio" name="player_action" value="fold"> fold </div>
                {% endif %}
                {% if "all-in" in players_db[id_p_now].possible_responses%}
                        <div class="form-control"><input class="form-check-input" type="radio" name="player_action" value="all-in"> all-in </div>
                {% endif %}
                {% if "raise" in players_db[id_p_now].possible_responses%}
                        <div class="form-control"><input class="form-check-input" type="radio" name="player_action" value="raise"> raise </div>
                {% endif %}
                {% if "call" in players_db[id_p_now].possible_responses%}
                        <div class="form-control"><input class="form-check-input" type="radio" name="player_action" value="call"> call </div>
                {% endif %}
                {% if "check" in players_db[id_p_now].possible_responses%}
                        <div class="form-control"><input class="form-check-input" type="radio" name="player_action" value="check"> check </div>
                {% endif %}
                <div class="checkbox mb-3"></div>
                <input class="btn btn-outline-dark me-2" type="submit" value="Сделать ход">
            </form>
        </div>
        {% endif %}
        {% if game.row == 0 %}
            <div class="start_block">
                <form method="POST">
                    <input type="hidden" name="row" value="1">
                    <input name="start-button" id="start-button" type="submit" class="btn btn-primary btn-lg btn-block">
                </form>
            </div>
        {% endif %}

        {% if game.players.split().index(game.dealer) == 0 %}
            <div class="dealer_button_1">
                <img src="static/img/dealer_button.png" width="50px">
            </div>
        {% endif %}
        {% if game.players.split().index(game.dealer) == 1 %}
            <div class="dealer_button_2">
                <img src="static/img/dealer_button.png" width="50px">
            </div>
        {% endif %}
        {% if game.players.split().index(game.dealer) == 2 %}
            <div class="dealer_button_3">
                <img src="static/img/dealer_button.png" width="50px">
            </div>
        {% endif %}
        {% if game.players.split().index(game.dealer) == 3 %}
            <div class="dealer_button_4">
                <img src="static/img/dealer_button.png" width="50px">
            </div>
        {% endif %}
        {% if game.players.split().index(game.dealer) == 4 %}
            <div class="dealer_button_5">
                <img src="static/img/dealer_button.png" width="50px">
            </div>
        {% endif %}
        {% if game.players.split().index(game.dealer) == 5 %}
            <div class="dealer_button_6">
                <img src="static/img/dealer_button.png" width="50px">
            </div>
        {% endif %}


    </div>

    {% if game.round_ended %}
        <div class="block_win">
            <div>
                <img src="static/img/winner_background.jpg" width="30%" style="opacity: 0.35;" class="win_img">
            </div>
        </div>
        <div  class="win_text">
            <p>Выиграл {{ game.winners.split()[0] }} <br> + {{game.pot}}</p>
        </div>
        <div class="end_button_next">
            <form method="POST">
                <input type="hidden" name="row" value="6">
                <input name="end_button" type="submit" class="btn btn-light btn-lg btn-block" value="Продолжить">
            </form>
        </div>
        <div class="end_button_final">
            <form method="POST">
                <input type="hidden" name="row" value="7">
                <input name="end_button" type="submit" class="btn btn-light btn-lg btn-block" value="Завершить">
            </form>
        </div>
    {% endif %}

</body>

    <script src="static/scripts/game_scrypt.js"></script>

</html>